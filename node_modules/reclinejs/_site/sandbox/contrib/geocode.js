var Geocode = {
  geonames: function(name, callback) {
    var geonamesApi = 'http://api.geonames.org/searchJSON?maxRows=1&username=okfn&q=';
    var queryUrl = geonamesApi + name;
    $.getJSON(queryUrl, function(data) {
      // strip off stuff
      if (data.totalResultsCount >= 1) {
        var result = data.geonames[0];
      } else {
        // TODO: raise error?
      }
      callback(result);
    });
  },

  // Geocode using Google's API
  //
  // Note that no API key is required by default
  //
  // Requires inclusion of Google Maps v3 JS library:
  //
  // http://maps.google.com/maps/api/js?sensor=false
  //
  // @param location_: either a string for location or object for geocoder.geocode method (e.g. { address: ..., region: ...})
  // @return (in callback) { lat: ..., lon: } object if value found
  google: function(location_, callback) {
    if (location_) {
      var loc = location_;
      if (typeof(location_) === 'string') {
        loc = {
          'address': loc
        };
      }
      var geocoder = new google.maps.Geocoder();
      geocoder.geocode(loc, function(data, status) {
          if (data) {
            var latlng = data[0].geometry.location;
            callback({lat: latlng.lat(), lon: latlng.lng()});
          }
          callback(null);
        }
      );
    } else {
      callback(null)
    }
  }
}


